---
title: "ShahRProjectPt1"
author: "Priyanshi Shah"
date: "2023-02-24"
output: html_document
---

```{r setup, include=FALSE}
library(ggplot2)
library(dplyr)
library(readr)
library(tibble)
library(vegan)
```

```{r}
#Add the comments as you do your analyzes
#To know more about the variables, just go to Dr. Kelley's rad website

rdata <- read.table("RTestData.txt", header = TRUE) #imported the data, and did header=True because the first row is titles 
View(rdata) #just checking out my data

strep=rdata$strep
fuso=rdata$fuso
lepto=rdata$lepto
prev=rdata$prev
veil=rdata$veil
deepest=rdata$deepest
```

#Part A: Univariate statistics with R
#Normality check and data transformation
(1)  Make histograms, run qqnorm and qqline of all bacteria and “deepest”. 
```{r}
#not normally distributed
hist(strep) 
hist(prev)
hist(lepto)
hist(fuso)
hist(veil) 
hist(deepest)

qqnorm(strep) 
qqline(strep)
qqnorm(prev)
qqline(prev)
qqnorm(lepto)
qqline(lepto)
qqnorm(fuso)
qqline(fuso)
qqnorm(veil)
qqline(veil)
qqnorm(deepest)
qqline(deepest)

```

(2)  Transform variables if non-normal and repeat histogram, qqnorm, qqline on 
transformed data. For transformations I suggest trying either sqrt() or log(). 
(3)  Example: lepto=sqrt(lepto)
```{r}
#OH MY GOD, LOOKS SO MUCH BETTER WITH THE TRANSFORMATIONS
deepest=sqrt(deepest)
fuso=sqrt(fuso)
lepto=sqrt(lepto)
prev=sqrt(prev)
veil=sqrt(veil)
strep=sqrt(strep)


hist(strep) 
hist(prev)
hist(lepto)
hist(fuso)
hist(veil) 
hist(deepest)

qqnorm(strep) 
qqline(strep)
qqnorm(prev)
qqline(prev)
qqnorm(lepto)
qqline(lepto)
qqnorm(fuso)
qqline(fuso)
qqnorm(veil)
qqline(veil)
qqnorm(deepest)
qqline(deepest)

```

#For the following, use the normalized (transformed) values. 
#One-way ANOVA and summary and boxplots: 
 
#(1)  Lepto by time 
```{r}

aov(lepto~time, data=rdata)
boxplot(lepto~time, data=rdata)
summary(lepto~time, data=rdata)

#(2)  Strep by time 

aov(strep~time, data=rdata)
boxplot(strep~time, data=rdata)
summary(strep~time, data=rdata)

```
#Correlation analysis (cor.test) 
#(1)  Strep vs. prev 
```{r}
cor.test(strep,prev)

#(2)  Strep vs. fuso 
cor.test(strep,fuso)

#(3)  Fuso vs. lepto 
cor.test(fuso,lepto)
```
 
#Linear regressions 
Use the lm command and use plot and abline to produce graphs. 
(1)  Strep vs. deepest 
```{r}

lm(strep~deepest, data=rdata)

#(2)  Fuso vs. deepest 

lm(fuso~deepest, data=rdata)

```

#Part B: Use ggplot2 to make pretty graphs 
#Produce the following graphs: 

(1)  ggplot histogram of prev variable. 

```{r}
ggplot(data = rdata, aes(x= prev))+
  geom_histogram()

```

(2)  ggplot scatterplot of strep by deepest, colored by time 
```{r}
ggplot(data = rdata, aes(x= strep, y=deepest, color= time))+
  geom_point(size=3, shape = 21)


```

(3)  ggplot scatterplot of fuso by deepest 
```{r}

ggplot(data = rdata, aes(x= fuso, y=deepest))+
  geom_point(size=3, shape = 22)

```

(4)  Same as 4 but use smoothing algorithm
```{r}

ggplot(data = rdata, aes(x= fuso, y=deepest))+
  geom_smooth()+
  geom_point(size=3, shape = 25)

```

#Part C: Vegan analysis 

```{r}
#new data frame with only the columns that I need 
rdata = data.frame(strep ,prev, fuso,lepto, veil, deepest)* 10

```

```{r}
#(1)  Calculate alpha diversity (Shannon) for the dataset. 

shannon <- diversity(rdata)
shannon


#(2)  Rarefy the data and make a plot using rarecurve. 

rdataAbund <- rowSums(rdata)
rdataAbund

rdatamin <- min(rowSums(rdata))
rdatamin

rRare <- rarefy(rdata, rdatamin)

rarecurve(rdata, col = "blue")

#(3)  Calculate Bray-Curtis dissimilarity matrix, show the matrix and plot a histogram. 


par(mfrow = c(1,2))
bray = vegdist(rdata, "bray")
gower = vegdist(rdata, "gower")

hist(bray, xlim = range(10, 100))
hist(gower, xlim = range(10, 100))

rdata_matrix=matrix(
   sample(1:100,300,replace=T),nrow=10, 
   dimnames=list(paste("community",1:10,sep=""),paste("sp",1:30,sep="")))
head(rdata_matrix)

example = metaMDS(rdata_matrix, k=5)
plot(example)

```


```{r}
# Make a multidimensional scaling plot using the Bray-Curtis matrix. 

plot(example$points)

rpoint <- data.frame(example$points)

```

